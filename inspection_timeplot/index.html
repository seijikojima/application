
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
<script src="https://unpkg.com/vue-chartjs/dist/vue-chartjs.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<meta http-equiv="content-type" charset="utf-8">

<div id="app">

  

    <div class="chart_frame">

      <img :src="img_path" width="200px">
      <div style="text-align :center">{{time}} {{img_path}} NG確率 : {{ng_prob}}%</div>

      <canvas id="myLineChart"></canvas>
      
      
    </div>
    
</div>


<script>

var app = new Vue({
  el: '#app',
  data: function () {
    return {
        id : 1,
        img_path : "./img/1.png",
        prob_table : [0,2.2,4.8,3.4,99.6,2.8,1,3,97.4,1.2,2.3,3.9],
        time : "スタート",
        message : "hello",
        labels : ["スタート"],
        ts : [0],
        ng_prob : 3.3
    }
  },
  methods: {

    render_chart : function(){
      var ctx = document.getElementById("myLineChart");
      var myLineChart = new Chart(ctx, {
      type : 'line',
      
      data: {
        labels : this.labels,
        datasets: [
          {
            label: '気温',
            data : this.ts,
            // data : [100,200,300,100],
            borderColor: "rgba(255,0,0,1)",
            backgroundColor: "rgba(0,0,0,0)",
            lineTension : 0
          }
        ],
      },
      options: {
        title: {
          display: true,
          // text: 'absorption data'
        },
        scales: {
          yAxes: [{
            ticks: {
              suggestedMax: 40,
              suggestedMin: 0,
              stepSize: 20,
              max : 100,
              callback: function(value, index, values){
                return  value +  '%'
              }
            }
          }]
        },
      }
    });
    },

    execute_inspection : function (){


   
    
      var today = new Date();
      this.time = today.getHours() + "時" + today.getMinutes() + "分" + today.getSeconds() + "秒";
      
      
      this.img_path = "./img/" + String(this.id) + ".png"

      this.labels.push(this.time)

      // console.log();

      this.ng_prob = this.prob_table[this.id]

      this.ts.push(this.ng_prob);
    
    if (this.id >= 9 ) this.id = 0
    
    if (this.ts.length >= 9 ){
      this.ts.shift()
      this.labels.shift()
    }

    this.id = this.id + 1

    this.render_chart();

    // console.log(this.ts)

    

    }


  },
  // ブラウザ起動時に実行
  mounted(){

    this.render_chart();
    
    setInterval(this.execute_inspection,3000);

    

  }
})


</script>





<!-- css -->
<style>

table{
  border-collapse: collapse;
  border-spacing: 0;
  width: 100%;
}

table tr{
  border-bottom: solid 1px #eee;
  cursor: pointer;
}

td {
  width : 300px;
}

.chart_frame{
  /* height:500px; */
  /* width:600px;  */

  text-align : center;
  width : 80%;
  margin:50px auto;
  border : solid 1px #aaa;
}


</style>